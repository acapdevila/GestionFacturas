@page
@model GestionFacturas.Web.Pages.Clientes.ListaGestionClientesModel
@{
    ViewData["Title"] = "Clientes";
}


<h2>@ViewData["Title"] </h2>
<div class="card">
    <div class="card-body">
        <div class="row">
            <div class="col">
                <h4>@ViewData["Title"]</h4> 
            </div>
            <div class="col-8">
                <a class="btn btn-primary border-white float-end" 
                   asp-page="@CrearClienteModel.NombrePagina">
                    @*  <partial name="Shared/Iconos/_PlusSquare" />*@
                    Nuevo cliente
                </a>
            </div>
        </div>
    </div>
</div>

<div class="card">
    <div id="toolbar" class="card-header">
        <form method="get">
            <div class="row">
                <div class="col-9">
                    <input asp-for="BuscarPor" class="form-control" placeholder="Search by program code or description..." />
                </div>
                <div class="col-3">
                    <input id="btnBuscar" name="boton" type="submit" value="Search" class="btn btn-primary" />
                </div>
            </div>
        </form>
    </div>
    <div class="card-body">
        <div class="table-responsive">
            <table id="table" class="table table-striped table-sm">
                <thead>
                <tr>
                    <th data-field="acciones" 
                        data-footer-formatter="footerFormatter" 
                        data-formatter="actionsFormatter" 
                        data-searchable="false">Acciones</th>

                    <th scope="col" 
                        data-field="@nameof(LineaListaGestionClientesVm.Id)" 
                        data-visible="false" 
                        data-searchable="false">ID</th>

                    <th scope="col"
                        data-field="@nameof(LineaListaGestionClientesVm.Nombre)">
                        Nombre
                    </th>

                    <th scope="col"
                        data-field="@nameof(LineaListaGestionClientesVm.NumeroIdentificacionFiscal)">
                        NIF
                    </th>

                    <th scope="col"
                        data-field="@nameof(LineaListaGestionClientesVm.NumFacturas)">
                        Facturas
                    </th>
                </tr>
                </thead>
            </table>
        </div>
    </div>
</div>

@section Scripts
{
    <partial name="_BoostrapTableScripts" />
    
     <script>
            $(function() {
                initTable();
            });
    
            function refrescar(){
                $("#table").bootstrapTable('refresh');
            }
    
            function initTable() {
    
                $("#@Html.IdFor(m => m.BuscarPor)").change(refrescar);
                
                $("#table").bootstrapTable('destroy').bootstrapTable({
                    toolbar:"#toolbar",
                    searchSelector:"#BuscarPor",
                    cookieIdTable : "@ListaGestionClientesModel.NombrePagina",
                    url: "@Url.Action("Get", "GridClientes")"
                });
            }
    
            function actionsFormatter(value, row, index) {
                return [
                    '<div class="btn-group">',
                    '<a class="btn btn-primary" href="@EditarClienteModel.NombrePagina/' + row.Id + '">',
                    'Edit',
                    '</a>',
                    '<button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split" data-bs-toggle="dropdown" aria-expanded="false">',
                    '<span class="visually-hidden">Toggle Dropdown</span>',
                    '</button>',
                    '<ul class="dropdown-menu">',
                    '<li><a class="dropdown-item text-danger" href="@EliminarClienteModel.NombrePagina/' + row.Id + '">',
                    'Delete',
                    '</a></li>',
                    '</ul>',
                    '</div>'
                ].join('');
            }
        </script>
}
